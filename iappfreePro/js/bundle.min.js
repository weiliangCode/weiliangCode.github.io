var app=angular.module("iappfree",["ionic"]);app.config(["$stateProvider","$urlRouterProvider","globalProvider",function(t,e,o){t.state("tabs",{url:"/tabs",templateUrl:"views/tabs.html",controller:"commonCtrl"}).state("tabs.home",{url:"/home",views:{"tab-home":{templateUrl:"views/home/home.html",controller:"homeCtrl"}}}).state("tabs.discount",{url:"/discount",views:{"tab-discount":{templateUrl:"views/discount/discount.html",controller:"discountCtrl"}}}).state("tabs.gratis",{url:"/gratis",views:{"tab-gratis":{templateUrl:"views/gratis/gratis.html",controller:"gratisCtrl"}}}).state("tabs.special",{url:"/special",views:{"tab-special":{templateUrl:"views/special/special.html"}}}).state("tabs.hotList",{url:"/hotList",views:{"tab-hotList":{templateUrl:"views/hotList/hotList.html"}}}).state("tabs.appInfo",{url:"/appInfo/:id",views:{"tab-home":{templateUrl:"views/common/appInfo.html",controller:"infoCtrl"}}}).state("tabs.set",{url:"/set",views:{"tab-home":{templateUrl:"views/common/set.html"}}}),e.otherwise("tabs/home"),o.globalPath="/iappfreePro/data"}]),app.controller("commonCtrl",["$scope","homeDataService","commonService",function(t,e,o){t.selectIndex=0,e.getTabsData(function(e){t.tabs=e},o.alertInfo),t.tabsAction=function(e){t.selectIndex=e}}]),app.service("commonService",["$ionicPopup",function(t){this.alertInfo=function(e,o){var a="";if(e)a=e;else if(o)switch(o){case 404:a="找不到文件";break;case 405:a="本地错误";break;case 500:case 505:a="服务器错误";break;default:a="未知错误"}else a="未知错误";t.alert({title:"提示",cssClass:"my-alert",template:'<div class="alert-info">'+a+"</div>",okText:"知道了",okType:"button-red"})}}]),app.provider("global",function(){this.globalPath="",this.$get=function(){var t={},e=this;return t.getPath=function(){return e.globalPath},t}}),app.controller("discountCtrl",["$scope","homeDataService","commonService",function(t,e,o){e.gethomeData({group:"discount",page:1},function(e){t.listData=e,console.log(e)},o.alertInfo)}]),app.controller("gratisCtrl",["$scope","homeDataService","commonService",function(t,e,o){e.gethomeData({group:"gratis",page:1},function(e){t.listData=e,console.log(e)},o.alertInfo)}]),app.service("homeDataService",["$http","global",function(t,e){this.gethomeData=function(o,a,i){t.get(e.getPath()+"/"+o.group+"Data&page="+o.page+".json").success(function(t){a(t.applications)}).error(function(t,e){console.log(t,e),console.log("请求失败"),i("",e)})},this.getTabsData=function(o,a){t.get(e.getPath()+"/tabsData.json").success(function(t){o(t)}).error(function(t,e){console.log(t,e),console.log("请求失败"),a("",e)})}}]),app.controller("homeCtrl",["$scope","homeDataService","commonService","$location",function(t,e,o,a){t.page=1,t.ifshowLoadMore=!0,e.gethomeData({group:"home",page:t.page},function(e){t.listData=e},o.alertInfo),t.showinfo=function(e){var o=t.listData[e].applicationId;a.path("/tabs/appInfo/"+o)},t.setBtn=function(){a.path("/tabs/set")},t.loadMoreData=function(){return t.page+=1,t.page>3?(t.$broadcast("scroll.infiniteScrollComplete"),void(t.ifshowLoadMore=!1)):void e.gethomeData({group:"home",page:t.page},function(e){t.listData=t.listData.concat(e),t.$broadcast("scroll.infiniteScrollComplete")},function(){t.$broadcast("scroll.infiniteScrollComplete"),o.alertInfo()})},t.refresh=function(){t.page=1,t.ifshowLoadMore=!0,e.gethomeData({group:"home",page:t.page},function(e){t.listData=e,t.$broadcast("scroll.refreshComplete")},function(){o.alertInfo(),t.$broadcast("scroll.refreshComplete")})}}]),app.controller("infoCtrl",["$scope","infoDataService","commonService","$location",function(t,e,o,a){e.getappinfoData(function(e){t.infoData=e,console.log(e)},o.alertInfo)}]),app.service("infoDataService",["$http","global",function(t,e){this.getappinfoData=function(o,a){t.get(e.getPath()+"/appinfo&id=455680974.json").success(function(t){o(t)}).error(function(t,e){console.log(t,e),console.log("请求失败"),a("",e)})}}]);