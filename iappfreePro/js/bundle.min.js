var app=angular.module("iappfree",["ionic"]);app.config(["$stateProvider","$urlRouterProvider","globalProvider",function(t,o,e){t.state("tabs",{url:"/tabs",templateUrl:"views/tabs.html",controller:"commonCtrl"}).state("tabs.home",{url:"/home",views:{"tab-home":{templateUrl:"views/home/home.html",controller:"homeCtrl"}}}).state("tabs.discount",{url:"/discount",views:{"tab-discount":{templateUrl:"views/discount/discount.html",controller:"discountCtrl"}}}).state("tabs.gratis",{url:"/gratis",views:{"tab-gratis":{templateUrl:"views/gratis/gratis.html",controller:"gratisCtrl"}}}).state("tabs.special",{url:"/special",views:{"tab-special":{templateUrl:"views/special/special.html"}}}).state("tabs.hotList",{url:"/hotList",views:{"tab-hotList":{templateUrl:"views/hotList/hotList.html"}}}).state("tabs.appInfo",{url:"/appInfo/:id",views:{"tab-home":{templateUrl:"views/common/appInfo.html",controller:"infoCtrl"}}}).state("tabs.appInfoD",{url:"/appInfoD/:id",views:{"tab-discount":{templateUrl:"views/common/appInfo.html",controller:"infoCtrl"}}}).state("tabs.set",{url:"/set",views:{"tab-home":{templateUrl:"views/common/set.html"}}}),o.otherwise("tabs/home"),e.globalPath="/iappfreePro/data"}]),app.controller("commonCtrl",["$scope","homeDataService","commonService",function(t,o,e){t.selectIndex=0,o.getTabsData(function(o){t.tabs=o},e.alertInfo),t.tabsAction=function(o){t.selectIndex=o}}]),app.service("commonService",["$ionicPopup",function(t){this.alertInfo=function(o,e){var a="";if(o)a=o;else if(e)switch(e){case 404:a="找不到文件";break;case 405:a="本地错误";break;case 500:case 505:a="服务器错误";break;default:a="未知错误"}else a="未知错误";t.alert({title:"提示",cssClass:"my-alert",template:'<div class="alert-info">'+a+"</div>",okText:"知道了",okType:"button-red"})}}]),app.provider("global",function(){this.globalPath="",this.$get=function(){var t={},o=this;return t.getPath=function(){return o.globalPath},t}}),app.controller("discountCtrl",["$scope","homeDataService","commonService","$location",function(t,o,e,a){o.gethomeData({group:"discount",page:1},function(o){t.listData=o,console.log(o)},e.alertInfo),t.showinfo=function(o){var e=t.listData[o].applicationId;a.path("/tabs/appInfoD/"+e)}}]),app.controller("gratisCtrl",["$scope","homeDataService","commonService",function(t,o,e){o.gethomeData({group:"gratis",page:1},function(o){t.listData=o,console.log(o)},e.alertInfo)}]),app.controller("infoCtrl",["$scope","infoDataService","commonService","$location",function(t,o,e,a){o.getappinfoData(function(o){t.infoData=o,console.log(o)},e.alertInfo)}]),app.service("infoDataService",["$http","global",function(t,o){this.getappinfoData=function(e,a){t.get(o.getPath()+"/appinfo&id=455680974.json").success(function(t){e(t)}).error(function(t,o){console.log(t,o),console.log("请求失败"),a("",o)})}}]),app.controller("homeCtrl",["$scope","homeDataService","commonService","$location",function(t,o,e,a){t.page=1,t.ifshowLoadMore=!0,o.gethomeData({group:"home",page:t.page},function(o){t.listData=o},e.alertInfo),t.showinfo=function(o){var e=t.listData[o].applicationId;a.path("/tabs/appInfo/"+e)},t.setBtn=function(){a.path("/tabs/set")},t.loadMoreData=function(){return t.page+=1,t.page>3?(t.$broadcast("scroll.infiniteScrollComplete"),void(t.ifshowLoadMore=!1)):void o.gethomeData({group:"home",page:t.page},function(o){t.listData=t.listData.concat(o),t.$broadcast("scroll.infiniteScrollComplete")},function(){t.$broadcast("scroll.infiniteScrollComplete"),e.alertInfo()})},t.refresh=function(){t.page=1,t.ifshowLoadMore=!0,o.gethomeData({group:"home",page:t.page},function(o){t.listData=o,t.$broadcast("scroll.refreshComplete")},function(){e.alertInfo(),t.$broadcast("scroll.refreshComplete")})}}]),app.service("homeDataService",["$http","global",function(t,o){this.gethomeData=function(e,a,n){t.get(o.getPath()+"/"+e.group+"Data&page="+e.page+".json").success(function(t){a(t.applications)}).error(function(t,o){console.log(t,o),console.log("请求失败"),n("",o)})},this.getTabsData=function(e,a){t.get(o.getPath()+"/tabsData.json").success(function(t){e(t)}).error(function(t,o){console.log(t,o),console.log("请求失败"),a("",o)})}}]);